version: 3
projects:
- name: tf-atlantis-elk
  dir: ./terraform
  workflow: custom

workflows:
  custom:
    plan:
      steps:
      - init
      - plan:
          extra_args:
            - -var
            - github_user=${{ .Vars.github_user }}
            - -var
            - github_token=${{ .Vars.github_token }}
            - -var
            - github_secret=${{ .Vars.github_secret }}

    apply:
      steps:
      - apply:
          extra_args:
            - -var
            - github_user=${{ .Vars.github_user }}
            - -var
            - github_token=${{ .Vars.github_token }}
            - -var
            - github_secret=${{ .Vars.github_secret }}
